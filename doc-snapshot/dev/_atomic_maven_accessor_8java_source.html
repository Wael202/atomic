<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Atomic Developer Documentation: AtomicMavenAccessor.java Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Atomic Developer Documentation
   &#160;<span id="projectnumber">0.3.0-SNAPSHOT</span>
   </div>
   <div id="projectbrief">Developer documentation and API</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_atomic_maven_accessor_8java_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AtomicMavenAccessor.java</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*******************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright 2015 Friedrich-Schiller-Universit√§t Jena</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * you may not use this file except in compliance with the License.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * You may obtain a copy of the License at</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *     http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * See the License for the specific language governing permissions and</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * limitations under the License.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * Contributors:</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *     Stephan Druskat - initial API and implementation</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *******************************************************************************/</span></div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="namespaceorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper.html">   19</a></span>&#160;<span class="keyword">package </span>org.corpus_tools.atomic.projects.pepper;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">import</span> java.io.BufferedReader;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">import</span> java.io.BufferedWriter;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">import</span> java.io.File;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">import</span> java.io.FileReader;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">import</span> java.io.IOException;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">import</span> java.io.PrintWriter;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">import</span> java.text.DecimalFormat;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">import</span> java.text.DecimalFormatSymbols;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">import</span> java.util.Collections;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">import</span> java.util.HashMap;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">import</span> java.util.HashSet;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">import</span> java.util.Iterator;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">import</span> java.util.List;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">import</span> java.util.Locale;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">import</span> java.util.Properties;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">import</span> java.util.Set;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">import</span> javax.xml.parsers.ParserConfigurationException;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">import</span> javax.xml.parsers.SAXParser;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">import</span> javax.xml.parsers.SAXParserFactory;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.apache.logging.log4j.LogManager;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.apache.logging.log4j.Logger;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.apache.maven.repository.internal.DefaultArtifactDescriptorReader;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.apache.maven.repository.internal.DefaultVersionRangeResolver;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.apache.maven.repository.internal.DefaultVersionResolver;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.apache.maven.repository.internal.MavenRepositorySystemUtils;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.apache.maven.repository.internal.SnapshotMetadataGeneratorFactory;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.apache.maven.repository.internal.VersionsMetadataGeneratorFactory;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.codehaus.plexus.util.FileUtils;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.AbstractRepositoryListener;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.DefaultRepositorySystemSession;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.RepositoryEvent;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.RepositorySystem;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.RepositorySystemSession;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.artifact.Artifact;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.artifact.DefaultArtifact;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.artifact.DefaultArtifactType;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.collection.CollectRequest;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.collection.CollectResult;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.collection.DependencyCollectionException;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.collection.DependencyGraphTransformer;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.collection.DependencyManager;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.collection.DependencySelector;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.collection.DependencyTraverser;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.connector.basic.BasicRepositoryConnectorFactory;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.graph.Dependency;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.graph.DependencyNode;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.impl.ArtifactDescriptorReader;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.impl.DefaultServiceLocator;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.impl.MetadataGeneratorFactory;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.impl.VersionRangeResolver;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.impl.VersionResolver;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.repository.LocalRepository;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.repository.LocalRepositoryManager;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.repository.RemoteRepository;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.resolution.ArtifactRequest;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.resolution.ArtifactResolutionException;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.resolution.ArtifactResult;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.resolution.VersionRangeRequest;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.resolution.VersionRangeResolutionException;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.resolution.VersionRangeResult;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.spi.connector.RepositoryConnectorFactory;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.spi.connector.transport.TransporterFactory;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.transfer.AbstractTransferListener;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.transfer.ArtifactNotFoundException;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.transfer.MetadataNotFoundException;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.transfer.TransferEvent;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.transfer.TransferResource;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.transport.file.FileTransporterFactory;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.transport.http.HttpTransporterFactory;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.util.artifact.DefaultArtifactTypeRegistry;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.util.graph.manager.ClassicDependencyManager;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.util.graph.selector.AndDependencySelector;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.util.graph.selector.ExclusionDependencySelector;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.util.graph.selector.OptionalDependencySelector;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.util.graph.selector.ScopeDependencySelector;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.util.graph.transformer.ChainedDependencyGraphTransformer;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.util.graph.transformer.ConflictResolver;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.util.graph.transformer.JavaDependencyContextRefiner;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.util.graph.transformer.JavaScopeDeriver;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.util.graph.transformer.JavaScopeSelector;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.util.graph.transformer.NearestVersionSelector;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.util.graph.transformer.SimpleOptionalitySelector;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.util.graph.traverser.FatArtifactTraverser;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.util.repository.SimpleArtifactDescriptorPolicy;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.util.version.GenericVersionScheme;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.version.InvalidVersionSpecificationException;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.version.Version;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.version.VersionRange;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.<a class="code" href="namespaceorg_1_1eclipse.html">eclipse</a>.aether.version.VersionScheme;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.osgi.framework.Bundle;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.osgi.framework.BundleException;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.xml.sax.Attributes;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.xml.sax.SAXException;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceorg.html">org</a>.xml.sax.ext.DefaultHandler2;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html">  127</a></span>&#160;<span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html">AtomicMavenAccessor</a> {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger log = LogManager.getLogger(<a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html">AtomicMavenAccessor</a>.class);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String BLACKLIST_PATH = <span class="stringliteral">&quot;./configuration/dependencies/blacklist.cfg&quot;</span>;</div><div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#a69ac225bddc2696dd2a64d15399df6d8">  137</a></span>&#160;        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String <a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#a69ac225bddc2696dd2a64d15399df6d8">ARTIFACT_ID_PEPPER_FRAMEWORK</a> = <span class="stringliteral">&quot;pepper-framework&quot;</span>;</div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#ab3d577efb7764c29cf46587027a207ad">  139</a></span>&#160;        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String <a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#ab3d577efb7764c29cf46587027a207ad">ARTIFACT_ID_PEPPER_PARENT</a> = <span class="stringliteral">&quot;pepper-parentModule&quot;</span>;</div><div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#a1fe636bc1fc7ca39eda1ad4dd3df672e">  141</a></span>&#160;        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String <a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#a1fe636bc1fc7ca39eda1ad4dd3df672e">KORPLING_MAVEN_REPO</a> = <span class="stringliteral">&quot;http://korpling.german.hu-berlin.de/maven2/&quot;</span>;</div><div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#a6f0f58c5787d0e826714364ebf136454">  143</a></span>&#160;        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String <a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#a6f0f58c5787d0e826714364ebf136454">CENTRAL_REPO</a> = <span class="stringliteral">&quot;http://central.maven.org/maven2/&quot;</span>;</div><div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#aec2f0e60a26143385856dec6ce3494f0">  145</a></span>&#160;        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String <a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#aec2f0e60a26143385856dec6ce3494f0">SONATYPE_SNAPSHOTS_REPO</a> = <span class="stringliteral">&quot;https://oss.sonatype.org/content/repositories/snapshots/&quot;</span>;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">enum</span> STATUS {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                OVERRIDABLE, FINAL;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DELIMITER = <span class="stringliteral">&quot;:&quot;</span>;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keyword">private</span> <span class="keyword">final</span> <a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_pepper_o_s_gi_connector.html">AtomicPepperOSGiConnector</a> atomicPepperOSGiConnector;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keyword">private</span> RepositorySystem mvnSystem = null;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keyword">private</span> Set&lt;String&gt; forbiddenFruits = null;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        HashMap&lt;String, RemoteRepository&gt; repos = null;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        RemoteRepository.Builder repoBuilder = null;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keyword">private</span> HashMap&lt;String, List&lt;Dependency&gt;&gt; parentDependencies = null;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keyword">private</span> <span class="keyword">final</span> String PATH_LOCAL_REPO;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#a16b6f3435123f00ec38117760b81ef6f">  176</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#a16b6f3435123f00ec38117760b81ef6f">AtomicMavenAccessor</a>(<a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_pepper_o_s_gi_connector.html">AtomicPepperOSGiConnector</a> atomicPepperOSGiConnector) {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                this.atomicPepperOSGiConnector = atomicPepperOSGiConnector;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                        DefaultServiceLocator locator = MavenRepositorySystemUtils.newServiceLocator();</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                        locator.addService(ArtifactDescriptorReader.class, DefaultArtifactDescriptorReader.class);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                        locator.addService(VersionResolver.class, DefaultVersionResolver.class);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                        locator.addService(VersionRangeResolver.class, DefaultVersionRangeResolver.class);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                        locator.addService(MetadataGeneratorFactory.class, SnapshotMetadataGeneratorFactory.class);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                        locator.addService(MetadataGeneratorFactory.class, VersionsMetadataGeneratorFactory.class);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                        locator.addService(RepositoryConnectorFactory.class, BasicRepositoryConnectorFactory.class);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                        locator.addService(TransporterFactory.class, FileTransporterFactory.class);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                        locator.addService(TransporterFactory.class, HttpTransporterFactory.class);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                        mvnSystem = locator.getService(RepositorySystem.class);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                repoBuilder = <span class="keyword">new</span> RemoteRepository.Builder(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;default&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                repos = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                forbiddenFruits = <span class="keyword">new</span> HashSet&lt;&gt;();</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                parentDependencies = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                PATH_LOCAL_REPO = atomicPepperOSGiConnector.<a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_pepper_o_s_gi_connector.html#a816cf5501b5a7e32d20fedc2c1f99d79">getAtomicPepperConfiguration</a>().<a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_pepper_configuration.html#a4e66aa0dfa500ba292d7c85eb2ef5b40">getTempPath</a>().getAbsolutePath().concat(<span class="stringliteral">&quot;/local-repo/&quot;</span>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <span class="keywordflow">try</span> {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                        File lr = <span class="keyword">new</span> File(PATH_LOCAL_REPO);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                        <span class="keywordflow">if</span> (lr.exists()) {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                FileUtils.deleteDirectory(lr);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                        }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                <span class="keywordflow">catch</span> (IOException e) {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                        log.warn(<span class="stringliteral">&quot;Failed to clean local repository.&quot;</span>);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                init();</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                initDependencies();</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> init() {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <span class="comment">/* init Maven utils */</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <span class="comment">/* read/write dependency blacklist */</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                File blacklistFile = <span class="keyword">new</span> File(BLACKLIST_PATH);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="keywordflow">if</span> (blacklistFile.exists()) {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                FileReader fR = <span class="keyword">new</span> FileReader(blacklistFile);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                                BufferedReader reader = <span class="keyword">new</span> BufferedReader(fR);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                String line = reader.readLine();</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                <span class="keywordflow">while</span> (line != null) {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                        forbiddenFruits.add(line);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                                        line = reader.readLine();</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                reader.close();</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                fR.close();</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                        }</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                        <span class="keywordflow">catch</span> (IOException e) {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                log.debug(<span class="stringliteral">&quot;Could not read blacklist file.&quot;</span>, e);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                        }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">boolean</span> initDependencies() {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                String frameworkVersion = atomicPepperOSGiConnector.getFrameworkVersion();</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <span class="keywordflow">if</span> (frameworkVersion.split(<span class="stringliteral">&quot;\\.&quot;</span>).length &gt; 3) { <span class="comment">// I.e., Is a snapshot version</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                        String[] segments = frameworkVersion.split(<span class="stringliteral">&quot;\\.&quot;</span>);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                        frameworkVersion = (segments[0] + <span class="stringliteral">&quot;.&quot;</span> + segments[1] + <span class="stringliteral">&quot;.&quot;</span> + segments[2] + <span class="stringliteral">&quot;-SNAPSHOT&quot;</span>);                 </div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                RemoteRepository repo = getRepo(<span class="stringliteral">&quot;korpling&quot;</span>, SONATYPE_SNAPSHOTS_REPO);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                getRepo(<span class="stringliteral">&quot;central&quot;</span>, CENTRAL_REPO);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">//              getRepo(&quot;sonatype-snapshots&quot;, SONATYPE_SNAPSHOTS_REPO);</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                <span class="keywordflow">if</span> (forbiddenFruits.isEmpty()) {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                        log.info(<span class="stringliteral">&quot;Configuring update mechanism ...&quot;</span>);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                        <span class="comment">/* maven access utils */</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                        Artifact pepArt = <span class="keyword">new</span> DefaultArtifact(<span class="stringliteral">&quot;org.corpus-tools&quot;</span>, ARTIFACT_ID_PEPPER_PARENT, <span class="stringliteral">&quot;pom&quot;</span>, frameworkVersion);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                        DefaultRepositorySystemSession session = getNewSession();</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                        <span class="comment">/* utils for dependency collection */</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                        CollectRequest collectRequest = <span class="keyword">new</span> CollectRequest();</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                        collectRequest.setRoot(<span class="keyword">new</span> Dependency(pepArt, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                        collectRequest.setRepositories(null);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                        collectRequest.addRepository(repo);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                        collectRequest.addRepository(repos.get(CENTRAL_REPO));</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                        collectRequest.addRepository(repos.get(SONATYPE_SNAPSHOTS_REPO));</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                        collectRequest.setRootArtifact(pepArt);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                CollectResult collectResult = mvnSystem.collectDependencies(session, collectRequest);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                List&lt;Dependency&gt; allDeps = getAllDependencies(collectResult.getRoot(), <span class="keyword">false</span>);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                                parentDependencies.put(frameworkVersion.replace(<span class="stringliteral">&quot;-SNAPSHOT&quot;</span>, <span class="stringliteral">&quot;&quot;</span>), allDeps);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                Bundle bundle = null;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                STATUS status = null;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                                <span class="keywordflow">for</span> (Dependency dependency : allDeps) {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                        bundle = atomicPepperOSGiConnector.getBundle(dependency.getArtifact().getGroupId(), dependency.getArtifact().getArtifactId(), null);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                        status = bundle == null || bundle.getHeaders().get(<span class="stringliteral">&quot;Bundle-SymbolicName&quot;</span>).contains(<span class="stringliteral">&quot;singleton:=true&quot;</span>) ? STATUS.FINAL : STATUS.OVERRIDABLE;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                                        forbiddenFruits.add(dependency.getArtifact().toString().concat(DELIMITER).concat(status.toString()).concat(DELIMITER).concat(bundle == null ? <span class="stringliteral">&quot;&quot;</span> : bundle.getSymbolicName()));</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                                }</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                                write2Blacklist();</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                                collectResult = null;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                        }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                        <span class="keywordflow">catch</span> (DependencyCollectionException e) {</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                                log.warn(<span class="stringliteral">&quot;An error occured initializing the update mechanism. Please check your internet connection.&quot;</span>, e);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                        }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                        session = null;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                        pepArt = null;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                        collectRequest = null;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                write2Blacklist();</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        }</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keyword">private</span> DefaultRepositorySystemSession getNewSession() {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                DefaultRepositorySystemSession session = <span class="keyword">new</span> DefaultRepositorySystemSession();</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                LocalRepository localRepo = <span class="keyword">new</span> LocalRepository(PATH_LOCAL_REPO);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                LocalRepositoryManager repoManager = mvnSystem.newLocalRepositoryManager(session, localRepo);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                session.setLocalRepositoryManager(repoManager);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                session.setRepositoryListener(repoListener);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                session.setTransferListener(transferListener);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                DependencyTraverser depTraverser = <span class="keyword">new</span> FatArtifactTraverser();</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                session.setDependencyTraverser(depTraverser);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                DependencyManager depManager = <span class="keyword">new</span> ClassicDependencyManager();</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                session.setDependencyManager(depManager);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                DependencySelector depFilter = <span class="keyword">new</span> AndDependencySelector(<span class="keyword">new</span> ScopeDependencySelector(<span class="stringliteral">&quot;test&quot;</span>, <span class="stringliteral">&quot;Test&quot;</span><span class="comment">/* , &quot;provided&quot; */</span> ), <span class="keyword">new</span> OptionalDependencySelector(), <span class="keyword">new</span> ExclusionDependencySelector());</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                session.setDependencySelector(depFilter);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                DependencyGraphTransformer transformer = <span class="keyword">new</span> ConflictResolver(<span class="keyword">new</span> NearestVersionSelector(), <span class="keyword">new</span> JavaScopeSelector(), <span class="keyword">new</span> SimpleOptionalitySelector(), <span class="keyword">new</span> JavaScopeDeriver());</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                <span class="keyword">new</span> ChainedDependencyGraphTransformer(transformer, <span class="keyword">new</span> JavaDependencyContextRefiner());</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                session.setDependencyGraphTransformer(transformer);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                DefaultArtifactTypeRegistry stereotypes = <span class="keyword">new</span> DefaultArtifactTypeRegistry();</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                stereotypes.add(<span class="keyword">new</span> DefaultArtifactType(<span class="stringliteral">&quot;pom&quot;</span>));</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                stereotypes.add(<span class="keyword">new</span> DefaultArtifactType(<span class="stringliteral">&quot;maven-plugin&quot;</span>, <span class="stringliteral">&quot;jar&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;java&quot;</span>));</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                stereotypes.add(<span class="keyword">new</span> DefaultArtifactType(<span class="stringliteral">&quot;jar&quot;</span>, <span class="stringliteral">&quot;jar&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;java&quot;</span>));</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                stereotypes.add(<span class="keyword">new</span> DefaultArtifactType(<span class="stringliteral">&quot;zip&quot;</span>, <span class="stringliteral">&quot;zip&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;java&quot;</span>));</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                stereotypes.add(<span class="keyword">new</span> DefaultArtifactType(<span class="stringliteral">&quot;ejb&quot;</span>, <span class="stringliteral">&quot;jar&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;java&quot;</span>));</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                stereotypes.add(<span class="keyword">new</span> DefaultArtifactType(<span class="stringliteral">&quot;ejb-client&quot;</span>, <span class="stringliteral">&quot;jar&quot;</span>, <span class="stringliteral">&quot;client&quot;</span>, <span class="stringliteral">&quot;java&quot;</span>));</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                stereotypes.add(<span class="keyword">new</span> DefaultArtifactType(<span class="stringliteral">&quot;test-jar&quot;</span>, <span class="stringliteral">&quot;jar&quot;</span>, <span class="stringliteral">&quot;tests&quot;</span>, <span class="stringliteral">&quot;java&quot;</span>));</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                stereotypes.add(<span class="keyword">new</span> DefaultArtifactType(<span class="stringliteral">&quot;javadoc&quot;</span>, <span class="stringliteral">&quot;jar&quot;</span>, <span class="stringliteral">&quot;javadoc&quot;</span>, <span class="stringliteral">&quot;java&quot;</span>));</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                stereotypes.add(<span class="keyword">new</span> DefaultArtifactType(<span class="stringliteral">&quot;java-source&quot;</span>, <span class="stringliteral">&quot;jar&quot;</span>, <span class="stringliteral">&quot;sources&quot;</span>, <span class="stringliteral">&quot;java&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>));</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                stereotypes.add(<span class="keyword">new</span> DefaultArtifactType(<span class="stringliteral">&quot;war&quot;</span>, <span class="stringliteral">&quot;war&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;java&quot;</span>, <span class="keyword">false</span>, <span class="keyword">true</span>));</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                stereotypes.add(<span class="keyword">new</span> DefaultArtifactType(<span class="stringliteral">&quot;ear&quot;</span>, <span class="stringliteral">&quot;ear&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;java&quot;</span>, <span class="keyword">false</span>, <span class="keyword">true</span>));</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                stereotypes.add(<span class="keyword">new</span> DefaultArtifactType(<span class="stringliteral">&quot;rar&quot;</span>, <span class="stringliteral">&quot;rar&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;java&quot;</span>, <span class="keyword">false</span>, <span class="keyword">true</span>));</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                stereotypes.add(<span class="keyword">new</span> DefaultArtifactType(<span class="stringliteral">&quot;par&quot;</span>, <span class="stringliteral">&quot;par&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;java&quot;</span>, <span class="keyword">false</span>, <span class="keyword">true</span>));</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                session.setArtifactTypeRegistry(stereotypes);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                session.setArtifactDescriptorPolicy(<span class="keyword">new</span> SimpleArtifactDescriptorPolicy(<span class="keyword">true</span>, <span class="keyword">true</span>));</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                Properties sysProps = System.getProperties();</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                session.setSystemProperties(sysProps);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                session.setConfigProperties(sysProps);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <span class="keywordflow">return</span> session;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        }</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keyword">private</span> <span class="keyword">final</span> MavenTransferListener transferListener = <span class="keyword">new</span> MavenTransferListener();</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keyword">private</span> <span class="keyword">final</span> MavenRepositoryListener repoListener = <span class="keyword">new</span> MavenRepositoryListener();</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#aa5c99f04d292609f9c0744f8e3f5b718">  343</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">boolean</span> <a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#aa5c99f04d292609f9c0744f8e3f5b718">update</a>(String groupId, String artifactId, String repositoryUrl, <span class="keywordtype">boolean</span> isSnapshot, <span class="keywordtype">boolean</span> ignoreFrameworkVersion, Bundle installedBundle) {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                <span class="keywordflow">if</span> (forbiddenFruits.isEmpty() &amp;&amp; !initDependencies()) {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                        log.warn(<span class="stringliteral">&quot;Update could not be performed, because the pepper dependencies could not be listed.&quot;</span>);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <span class="keywordflow">if</span> (log.isTraceEnabled()) {</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                        log.trace(<span class="stringliteral">&quot;Starting update process for &quot;</span> + groupId + <span class="stringliteral">&quot;, &quot;</span> + artifactId + <span class="stringliteral">&quot;, &quot;</span> + repositoryUrl + <span class="stringliteral">&quot;, isSnapshot=&quot;</span> + isSnapshot + <span class="stringliteral">&quot;, ignoreFrameworkVersion=&quot;</span> + ignoreFrameworkVersion + <span class="stringliteral">&quot;, installedBundle=&quot;</span> + installedBundle);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                        log.info(<span class="stringliteral">&quot;Starting update process for &quot;</span> + artifactId);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                String newLine = System.getProperty(<span class="stringliteral">&quot;line.separator&quot;</span>);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                DefaultRepositorySystemSession session = getNewSession();</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                <span class="keywordtype">boolean</span> <a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#aa5c99f04d292609f9c0744f8e3f5b718">update</a> = <span class="keyword">true</span>; <span class="comment">// MUST be born true!</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                <span class="comment">/* build repository */</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                RemoteRepository repo = getRepo(<span class="stringliteral">&quot;repo&quot;</span>, repositoryUrl);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <span class="comment">/* build artifact */</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                Artifact artifact = <span class="keyword">new</span> DefaultArtifact(groupId, artifactId, <span class="stringliteral">&quot;zip&quot;</span>, <span class="stringliteral">&quot;[0,)&quot;</span>);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                <span class="keywordflow">try</span> {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                        <span class="comment">/* version range request */</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                        VersionRangeRequest rangeRequest = <span class="keyword">new</span> VersionRangeRequest();</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                        rangeRequest.addRepository(repo);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                        rangeRequest.setArtifact(artifact);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                        VersionRangeResult rangeResult = mvnSystem.resolveVersionRange(session, rangeRequest);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                        rangeRequest.setArtifact(artifact);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                        <span class="comment">/* utils needed for request */</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                        ArtifactRequest artifactRequest = <span class="keyword">new</span> ArtifactRequest();</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                        artifactRequest.addRepository(repo);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                        ArtifactResult artifactResult = null;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                        <span class="comment">/* get all pepperModules versions listed in the maven repository */</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                        List&lt;Version&gt; versions = rangeResult.getVersions();</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                        Collections.reverse(versions);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                        <span class="comment">/* utils for version comparison */</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                        Iterator&lt;Version&gt; itVersions = versions.iterator();</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                        VersionScheme vScheme = <span class="keyword">new</span> GenericVersionScheme();</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                        <span class="keywordtype">boolean</span> srcExists = <span class="keyword">false</span>;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                        Version installedVersion = installedBundle == null ? vScheme.parseVersion(<span class="stringliteral">&quot;0.0.0&quot;</span>) : vScheme.parseVersion(installedBundle.getVersion().toString().replace(<span class="stringliteral">&quot;.SNAPSHOT&quot;</span>, <span class="stringliteral">&quot;-SNAPSHOT&quot;</span>));</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                        Version newestVersion = null;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                        <span class="comment">/* compare, if the listed version really exists in the maven repository */</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        File file = null;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                        <span class="keywordflow">while</span> (!srcExists &amp;&amp; itVersions.hasNext() &amp;&amp; <a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#aa5c99f04d292609f9c0744f8e3f5b718">update</a>) {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                                newestVersion = itVersions.next();</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                artifact = <span class="keyword">new</span> DefaultArtifact(groupId, artifactId, <span class="stringliteral">&quot;zip&quot;</span>, newestVersion.toString());</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                <span class="keywordflow">if</span> (!(artifact.isSnapshot() &amp;&amp; !isSnapshot)) {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                        update = newestVersion.compareTo(installedVersion) &gt; 0;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                                        artifactRequest.setArtifact(artifact);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                                        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                                artifactResult = mvnSystem.resolveArtifact(session, artifactRequest);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                                artifact = artifactResult.getArtifact();</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                                                srcExists = update &amp;&amp; artifact.getFile().exists();</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                                                file = artifact.getFile();</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                                        }</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                                        <span class="keywordflow">catch</span> (ArtifactResolutionException e) {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                                                log.warn(<span class="stringliteral">&quot;Plugin version &quot;</span> + newestVersion + <span class="stringliteral">&quot; could not be found in repository. Checking the next lower version ...&quot;</span>);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                                        }</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                        }</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                        update &amp;= file != null;<span class="comment">// in case of only snapshots in the maven repository vs. isSnapshot=false</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                        <span class="comment">/* if an update is possible/necessary, perform dependency collection and installation */</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                        <span class="keywordflow">if</span> (update) {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                <span class="comment">/* create list of necessary repositories */</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                Artifact pom = <span class="keyword">new</span> DefaultArtifact(artifact.getGroupId(), artifact.getArtifactId(), <span class="stringliteral">&quot;pom&quot;</span>, artifact.getVersion());</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                artifactRequest.setArtifact(pom);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                <span class="keywordtype">boolean</span> pomReadingErrors = <span class="keyword">false</span>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                                <span class="keywordflow">try</span> {</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                        artifactResult = null;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                        artifactResult = mvnSystem.resolveArtifact(session, artifactRequest);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                <span class="keywordflow">catch</span> (ArtifactResolutionException e1) {</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                                        pomReadingErrors = <span class="keyword">true</span>;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                                }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                                List&lt;RemoteRepository&gt; repoList = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                repoList.add(repos.get(CENTRAL_REPO));</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">//                              repoList.add(repos.get(SONATYPE_SNAPSHOTS_REPO));</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                                repoList.add(repos.get(repositoryUrl));</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                <span class="keywordflow">if</span> (artifactResult != null &amp;&amp; artifactResult.getArtifact().getFile().exists()) {</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                                SAXParser saxParser = SAXParserFactory.newInstance().newSAXParser();</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                                saxParser.parse(artifactResult.getArtifact().getFile().getAbsolutePath(), <span class="keyword">new</span> POMReader(repoList));</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                        }</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                                        <span class="keywordflow">catch</span> (SAXException | IOException | ParserConfigurationException e) {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                                pomReadingErrors = <span class="keyword">true</span>;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                        }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                }</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                <span class="keywordflow">if</span> (pomReadingErrors) {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                        log.warn(<span class="stringliteral">&quot;Could not determine all relevant repositories, update might fail. Trying to continue ...&quot;</span>);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                                        repoList.add(repos.get(KORPLING_MAVEN_REPO));</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                                }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                                <span class="comment">/* remove older version */</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                                <span class="keywordflow">if</span> (installedBundle != null) {</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                                        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                                                <span class="keywordflow">if</span> (!atomicPepperOSGiConnector.remove(installedBundle.getSymbolicName())) {</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                                                        log.warn(<span class="stringliteral">&quot;Could not remove older version. Update process aborted.&quot;</span>);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                                                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                                                }</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                        }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                                        <span class="keywordflow">catch</span> (BundleException | IOException e) {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                                                log.warn(<span class="stringliteral">&quot;An error occured while trying to remove OSGi bundle &quot;</span> + installedBundle.getSymbolicName() + <span class="stringliteral">&quot;. This may cause update problems. Trying to continue ...&quot;</span>);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                                        }</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                                <span class="comment">/* utils for file-collection */</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                                List&lt;Artifact&gt; installArtifacts = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                installArtifacts.add(artifact);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                <span class="comment">/* utils for dependency collection */</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                                CollectRequest collectRequest = <span class="keyword">new</span> CollectRequest();</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                                collectRequest.setRoot(<span class="keyword">new</span> Dependency(artifact, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                                collectRequest.setRepositories(repoList);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                                CollectResult collectResult = mvnSystem.collectDependencies(session, collectRequest);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                                List&lt;Dependency&gt; allDependencies = getAllDependencies(collectResult.getRoot(), <span class="keyword">true</span>);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                <span class="comment">/*</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">                                 * we have to remove the dependencies of pepperParent from the dependency list, since they are (sometimes) not already on the blacklist</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">                                 */</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                                String parentVersion = null;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; allDependencies.size() &amp;&amp; parentVersion == null; i++) {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                        <span class="keywordflow">if</span> (ARTIFACT_ID_PEPPER_FRAMEWORK.equals(allDependencies.get(i).getArtifact().getArtifactId())) {</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                                parentVersion = allDependencies.get(i).getArtifact().getVersion();</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                                        }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                                }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                <span class="keywordflow">if</span> (parentVersion == null) {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                                        log.warn(artifactId + <span class="stringliteral">&quot;: Could not perform update: pepper-parent version could not be determined.&quot;</span>);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                }</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                VersionRange range = isCompatiblePlugin(parentVersion);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                                <span class="keywordflow">if</span> (!ignoreFrameworkVersion &amp;&amp; range != null) {</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                                        log.info((<span class="keyword">new</span> StringBuilder()).append(<span class="stringliteral">&quot;No update was performed because of a version incompatibility according to pepper-framework: &quot;</span>).append(newLine).append(artifactId).append(<span class="stringliteral">&quot; only supports &quot;</span>).append(range.toString()).append(<span class="stringliteral">&quot;, but &quot;</span>).append(atomicPepperOSGiConnector.getFrameworkVersion()).append(<span class="stringliteral">&quot; is installed!&quot;</span>).append(newLine).append(<span class="stringliteral">&quot;You can make pepper ignore this by using \&quot;update&quot;</span>).append(isSnapshot ? <span class="stringliteral">&quot; snapshot &quot;</span> : <span class="stringliteral">&quot; &quot;</span>).append(<span class="stringliteral">&quot;iv &quot;</span>).append(artifactId).append(<span class="stringliteral">&quot;\&quot;&quot;</span>).toString());</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                                allDependencies = cleanDependencies(allDependencies, session, parentVersion);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                Bundle bundle = null;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                Dependency dependency = null;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                                <span class="comment">// in the following we ignore the first dependency (i=0), because it is the module itself</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; allDependencies.size(); i++) {</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                        dependency = allDependencies.get(i);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                                        <span class="keywordflow">if</span> (!ARTIFACT_ID_PEPPER_FRAMEWORK.equals(dependency.getArtifact().getArtifactId())) {</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                                artifactRequest = <span class="keyword">new</span> ArtifactRequest();</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                                                artifactRequest.setArtifact(dependency.getArtifact());</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                                artifactRequest.setRepositories(repoList);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                                                <span class="keywordflow">try</span> {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                                                        artifactResult = mvnSystem.resolveArtifact(session, artifactRequest);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                                                        installArtifacts.add(artifactResult.getArtifact());</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                                                }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                                                <span class="keywordflow">catch</span> (ArtifactResolutionException e) {</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                                                        log.warn(<span class="stringliteral">&quot;Artifact &quot;</span> + dependency.getArtifact().getArtifactId() + <span class="stringliteral">&quot; could not be resolved. Dependency will not be installed.&quot;</span>);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                                                        <span class="keywordflow">if</span> (!Boolean.parseBoolean(atomicPepperOSGiConnector.getPepperStarterConfiguration().getProperty(<span class="stringliteral">&quot;pepper.forceUpdate&quot;</span>).toString())) {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                                                                log.error(<span class="stringliteral">&quot;Artifact &quot;</span>.concat(artifact.getArtifactId()).concat(<span class="stringliteral">&quot; will not be installed. Resolution of dependency &quot;</span>).concat(dependency.getArtifact().getArtifactId()).concat(<span class="stringliteral">&quot; failed and \&quot;force update\&quot; is disabled in pepper.properties.&quot;</span>));</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                                                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                                                        }</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                                                }</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                                        }</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                artifact = null;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                Artifact installArtifact = null;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = installArtifacts.size() - 1; i &gt;= 0; i--) {</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                                        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                                                installArtifact = installArtifacts.get(i);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                                                log.info(<span class="stringliteral">&quot;installing: &quot;</span> + installArtifact);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                                                bundle = atomicPepperOSGiConnector.<a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_pepper_o_s_gi_connector.html#a6596ca087fcd84ddccfabd898c382a51">installAndCopy</a>(installArtifact.getFile().toURI());</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                                                <span class="keywordflow">if</span> (i != 0) {<span class="comment">// the module itself must not be put on the blacklist</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                                                        putOnBlacklist(installArtifact);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                                                }</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (installedBundle != null) {</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                                                        atomicPepperOSGiConnector.remove(installedBundle.getSymbolicName());</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                                                        log.info(<span class="stringliteral">&quot;Successfully removed version &quot;</span>.concat(installedBundle.getVersion().toString()).concat(<span class="stringliteral">&quot; of &quot;</span>).concat(artifactId));</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                                }</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                                                <span class="keywordflow">if</span> (bundle != null) {</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                                                        bundle.<a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_pepper_o_s_gi_connector.html#a17789d908d5adfe549a2fbf5615d0175">start</a>();</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                                }</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                                        }</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                                        <span class="keywordflow">catch</span> (IOException | BundleException e) {</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                                <span class="keywordflow">if</span> (log.isTraceEnabled()) {</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                                        log.trace(<span class="stringliteral">&quot;File could not be installed: &quot;</span> + installArtifact + <span class="stringliteral">&quot; (&quot;</span> + installArtifact.getFile() + <span class="stringliteral">&quot;); &quot;</span> + e.getClass().getSimpleName());</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                                                }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                                                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                                                        log.warn(<span class="stringliteral">&quot;File could not be installed: &quot;</span> + installArtifact.getFile());</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                                }</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                                        }</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                                }</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                                <span class="comment">/*</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">                                 * btw: root is not supposed to be stored as forbidden dependency. This makes the removal of a module much less complicated. If a pepper module would be put onto the blacklist and the bundle would be removed, we always had</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">                                 * to make sure, it its entry on the blacklist would be removed. Assuming the entry would remain on the blacklist, the module could be reinstalled, BUT(!) the dependencies would all be dropped and never being installed</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">                                 * again, since the modules node dominates all other nodes in the dependency tree.</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">                                 */</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                                write2Blacklist();</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                        }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                }</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                <span class="keywordflow">catch</span> (VersionRangeResolutionException | InvalidVersionSpecificationException | DependencyCollectionException e) {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                        <span class="keywordflow">if</span> (e instanceof DependencyCollectionException) {</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                Throwable t = e.getCause();</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                                <span class="keywordflow">while</span> (t.getCause() != null) {</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                        t = t.getCause();</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                <span class="keywordflow">if</span> (t instanceof ArtifactNotFoundException) {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                        <span class="keywordflow">if</span> (log.isDebugEnabled()) {</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                                                log.debug(t.getMessage(), e);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                                        }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                                                log.warn(<span class="stringliteral">&quot;Update of &quot;</span> + artifactId + <span class="stringliteral">&quot; failed, could not resolve dependencies &quot;</span><span class="comment">/* , e */</span>);<span class="comment">// TODO decide</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                                        }</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                }</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                        }</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                        update = <span class="keyword">false</span>;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#aa5c99f04d292609f9c0744f8e3f5b718">update</a>;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keyword">private</span> VersionRange isCompatiblePlugin(String pluginFrameworkVersion) {</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                VersionScheme vScheme = <span class="keyword">new</span> GenericVersionScheme();</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                Version frameworkVersion;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                <span class="keywordflow">try</span> {</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                        frameworkVersion = vScheme.parseVersion(atomicPepperOSGiConnector.getFrameworkVersion().replace(<span class="stringliteral">&quot;.SNAPSHOT&quot;</span>, <span class="stringliteral">&quot;-SNAPSHOT&quot;</span>));</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                        <span class="keyword">final</span> Version depParentVersion = vScheme.parseVersion(pluginFrameworkVersion);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                        <span class="keywordtype">int</span> m = 1 + Integer.parseInt(depParentVersion.toString().split(<span class="stringliteral">&quot;\\.&quot;</span>)[0]);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                        <span class="keyword">final</span> Version maxVersion = vScheme.parseVersion(m + <span class="stringliteral">&quot;.0.0&quot;</span>);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                        String rangeString = <span class="stringliteral">&quot;[&quot;</span>.concat(pluginFrameworkVersion).concat(<span class="stringliteral">&quot;,&quot;</span>).concat(maxVersion.toString()).concat(<span class="stringliteral">&quot;)&quot;</span>);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                        VersionRange range = vScheme.parseVersionRange(rangeString);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                        <span class="keywordflow">if</span> (!range.containsVersion(frameworkVersion)) {</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                <span class="keywordflow">return</span> range;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                        }</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                }</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                <span class="keywordflow">catch</span> (InvalidVersionSpecificationException e) {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                        log.error(<span class="stringliteral">&quot;Could not compare required framework version to running framework. Trying to perform update anyway...&quot;</span>);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                }</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        }</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keyword">private</span> List&lt;Dependency&gt; getAllDependencies(DependencyNode startNode, <span class="keywordtype">boolean</span> skipFramework) {</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                List&lt;Dependency&gt; retVal = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                retVal.add(startNode.getDependency());</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                <span class="keywordflow">for</span> (DependencyNode node : startNode.getChildren()) {</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                        <span class="keywordtype">boolean</span> isFramework = ARTIFACT_ID_PEPPER_FRAMEWORK.equals(node.getArtifact().getArtifactId());</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                        <span class="keywordtype">boolean</span> isSalt = node.getArtifact().getArtifactId().contains(<span class="stringliteral">&quot;salt-&quot;</span>);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                        <span class="keywordflow">if</span> ((isFramework &amp;&amp; !skipFramework) || (!isFramework &amp;&amp; !isSalt)) {</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                                String blackListLine = getBlackListString(node.getArtifact());</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                <span class="keywordflow">if</span> (blackListLine != null &amp;&amp; blackListLine.split(DELIMITER)[4].equals(STATUS.FINAL.toString())) {<span class="comment">// dependency already installed AND singleton</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                                        <span class="comment">// do nothing at the Moment (TODO-&gt; maybe implement a version range check, that enables an exchange of singletons)</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                <span class="keywordflow">else</span> {<span class="comment">// dependency not installed yet or not singleton</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                        <span class="keywordflow">if</span> (<span class="stringliteral">&quot;provided&quot;</span>.equalsIgnoreCase(startNode.getDependency().getScope())) {</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                                                putOnBlacklist(node.getArtifact());</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                                                <span class="keywordflow">return</span> Collections.&lt;Dependency&gt; emptyList();</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                                        }</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                                                retVal.addAll(getAllDependencies(node, skipFramework));</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                                        }</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                                }</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                        }</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (skipFramework &amp;&amp; isFramework) {<span class="comment">// we need this for checking compatibility</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                retVal.add(node.getDependency());</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                        }</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                }</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                <span class="keywordflow">return</span> retVal;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        }</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> putOnBlacklist(Artifact artifact) {</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                <span class="keywordflow">if</span> (getBlackListString(artifact) == null) {<span class="comment">// for safety reasons (future use of this method, etc) we do the check</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                        Bundle bundle = atomicPepperOSGiConnector.getBundle(artifact.getGroupId(), artifact.getArtifactId(), null);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                        STATUS status = bundle == null || !atomicPepperOSGiConnector.isSingleton(bundle) ? STATUS.OVERRIDABLE : STATUS.FINAL;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                        forbiddenFruits.add(artifact.toString().concat(DELIMITER).concat(status.toString()).concat(DELIMITER).concat(bundle == null ? <span class="stringliteral">&quot;&quot;</span> : bundle.getSymbolicName()));</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                        log.debug(<span class="stringliteral">&quot;Put dependency on blacklist: &quot;</span>.concat(artifact.toString()));</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                }</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        }</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keyword">private</span> String getBlackListString(Artifact artifact) {</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                String as = artifact.toString().substring(0, artifact.toString().lastIndexOf(DELIMITER.charAt(0)));</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                <span class="keywordflow">for</span> (String artifactString : forbiddenFruits) {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                        <span class="keywordflow">if</span> (artifactString.startsWith(as)) {</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                                <span class="keywordflow">return</span> artifactString;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                        }</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        }</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> write2Blacklist() {</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                File blacklistFile = <span class="keyword">new</span> File(BLACKLIST_PATH);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                <span class="keywordflow">if</span> (!blacklistFile.exists()) {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                        blacklistFile.getParentFile().mkdirs();</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                }</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                <span class="keywordflow">try</span> {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                        blacklistFile.createNewFile();</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                        PrintWriter fW = <span class="keyword">new</span> PrintWriter(blacklistFile);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                        BufferedWriter bW = <span class="keyword">new</span> BufferedWriter(fW);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                        <span class="keywordflow">for</span> (String s : forbiddenFruits) {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                bW.write(s);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                                bW.newLine();</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                        }</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                        bW.close();</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                        fW.close();</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                }</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                <span class="keywordflow">catch</span> (IOException e) {</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                        log.debug(<span class="stringliteral">&quot;Could not write blacklist file.&quot;</span>);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                }</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        }</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno"><a class="line" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#a1034a18ed961180122b66796840aef79">  663</a></span>&#160;        <span class="keyword">public</span> String <a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#a1034a18ed961180122b66796840aef79">getBlacklist</a>() {</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                String lineSeparator = System.getProperty(<span class="stringliteral">&quot;line.separator&quot;</span>);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                String indent = <span class="stringliteral">&quot;\t&quot;</span>;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                StringBuilder retVal = (<span class="keyword">new</span> StringBuilder()).append(lineSeparator);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                retVal.append(indent).append(<span class="stringliteral">&quot;installed dependencies:&quot;</span>).append(lineSeparator).append(lineSeparator);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                <span class="keywordflow">for</span> (String s : forbiddenFruits) {</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                        retVal.append(indent).append(s).append(lineSeparator);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                }</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                <span class="keywordflow">return</span> retVal.toString();</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keyword">private</span> List&lt;Dependency&gt; cleanDependencies(List&lt;Dependency&gt; dependencies, RepositorySystemSession session, String parentVersion) {</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                <span class="keywordflow">try</span> {</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                        <span class="keyword">final</span> List&lt;Dependency&gt; parentDeps;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                        List&lt;Dependency&gt; checkList = parentDependencies.get(parentVersion.replace(<span class="stringliteral">&quot;-SNAPSHOT&quot;</span>, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                        <span class="keywordflow">if</span> (checkList == null) {</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                                CollectRequest collectRequest = <span class="keyword">new</span> CollectRequest();</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                                collectRequest.setRoot(<span class="keyword">new</span> Dependency(<span class="keyword">new</span> DefaultArtifact(<span class="stringliteral">&quot;org.corpus-tools&quot;</span>, ARTIFACT_ID_PEPPER_PARENT, <span class="stringliteral">&quot;pom&quot;</span>, parentVersion), <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                                collectRequest.addRepository(repos.get(CENTRAL_REPO));</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">//                              collectRequest.addRepository(repos.get(KORPLING_MAVEN_REPO));</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                                collectRequest.addRepository(repos.get(SONATYPE_SNAPSHOTS_REPO));</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                                CollectResult collectResult;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                                collectResult = mvnSystem.collectDependencies(session, collectRequest);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                                parentDeps = getAllDependencies(collectResult.getRoot(), <span class="keyword">false</span>);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                                parentDependencies.put(parentVersion.replace(<span class="stringliteral">&quot;-SNAPSHOT&quot;</span>, <span class="stringliteral">&quot;&quot;</span>), parentDeps);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                        }</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                                parentDeps = checkList;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                        }</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                        Iterator&lt;Dependency&gt; itDeps = parentDeps.iterator();</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                        Dependency next = itDeps.next();</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                        <span class="keywordflow">while</span> (!ARTIFACT_ID_PEPPER_FRAMEWORK.equals(next.getArtifact().getArtifactId()) &amp;&amp; itDeps.hasNext()) {</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                                next = itDeps.next();</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                        }</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                        itDeps = null;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                        <span class="keywordtype">int</span> j = 0;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                        List&lt;Dependency&gt; newDeps = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                        STATUS status = null;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; dependencies.size(); i++) {</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                                j = 0;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                                next = dependencies.get(i);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                                status = getDependencyStatus(next.toString());</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                                <span class="keywordflow">while</span> (j &lt; parentDeps.size() &amp;&amp; !(next.getArtifact().getArtifactId().equals(parentDeps.get(j).getArtifact().getArtifactId()) || STATUS.OVERRIDABLE.equals(status))) {</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                                        j++;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                                }</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                                <span class="keywordflow">if</span> (j == parentDeps.size() || STATUS.OVERRIDABLE.equals(status)) {</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                                        newDeps.add(next);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                                }</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                                        forbiddenFruits.add(next.getArtifact().toString() + DELIMITER + STATUS.FINAL);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                                        log.debug(<span class="stringliteral">&quot;The following dependency was put on blacklist, because it equals a parent dependency: &quot;</span> + next.getArtifact().toString());</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                                }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                        }</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                        <span class="keywordflow">return</span> newDeps;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                }</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                <span class="keywordflow">catch</span> (DependencyCollectionException e) {</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                        log.warn(<span class="stringliteral">&quot;Could not collect dependencies for parent. No dependencies will be installed.&quot;</span>);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                }</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                ArrayList&lt;Dependency&gt; retVal = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                <span class="keywordflow">return</span> retVal;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        }</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="keyword">private</span> STATUS getDependencyStatus(String dependencyString) {</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                dependencyString = dependencyString.substring(0, dependencyString.lastIndexOf(<span class="charliteral">&#39;:&#39;</span>));</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                <span class="keywordflow">for</span> (String fruit : forbiddenFruits) {</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                        <span class="keywordflow">if</span> (fruit.startsWith(dependencyString)) {</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                                <span class="keywordflow">if</span> (fruit.split(DELIMITER)[4].equals(STATUS.FINAL.toString())) {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                                        <span class="keywordflow">return</span> STATUS.FINAL;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                                }</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                                <span class="keywordflow">return</span> STATUS.OVERRIDABLE;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                        }</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                }</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        }</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keyword">private</span> RemoteRepository getRepo(String <span class="keywordtype">id</span>, String url) {</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                RemoteRepository repo = repos.get(url);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                <span class="keywordflow">if</span> (repo == null) {</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                        repoBuilder.setId(<span class="keywordtype">id</span>);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                        repoBuilder.setUrl(url);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                        repo = repoBuilder.build();</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                        repos.put(url, repo);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                }</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                <span class="keywordflow">return</span> repo;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        }</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno"><a class="line" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#ad94713d67dee7e7b228b5a7a0545b6a4">  768</a></span>&#160;        <span class="keyword">public</span> String <a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#ad94713d67dee7e7b228b5a7a0545b6a4">printDependencies</a>(String groupId, String artifactId, String version, String repositoryUrl) {</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                <span class="comment">/* repositories */</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                RemoteRepository repo = null;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                <span class="keywordflow">if</span> (repositoryUrl == null) {</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                        repo = getRepo(<span class="stringliteral">&quot;korpling&quot;</span>, KORPLING_MAVEN_REPO);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                        repo = getRepo(<span class="stringliteral">&quot;repository&quot;</span>, repositoryUrl);</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                }</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                <span class="comment">/* version range resolution and dependency collection */</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                DefaultRepositorySystemSession session = getNewSession();</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                Artifact artifact = <span class="keyword">new</span> DefaultArtifact(groupId, artifactId, <span class="stringliteral">&quot;pom&quot;</span>, version == null ? <span class="stringliteral">&quot;[0,)&quot;</span> : version);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                <span class="keywordflow">if</span> (version == null) {</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                        VersionRangeRequest request = <span class="keyword">new</span> VersionRangeRequest();</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                        request.setArtifact(artifact);</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                        <span class="keywordflow">if</span> (repositoryUrl == null) {</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                                request.addRepository(repos.get(CENTRAL_REPO));</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                                request.addRepository(repos.get(SONATYPE_SNAPSHOTS_REPO));</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                        }</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                        request.addRepository(repo);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                                VersionRangeResult rangeResult = mvnSystem.resolveVersionRange(session, request);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                                version = rangeResult.getHighestVersion().toString();</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                                artifact.setVersion(version);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                        }</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                        <span class="keywordflow">catch</span> (VersionRangeResolutionException e) {</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                                log.error(<span class="stringliteral">&quot;Could not determine newest version.&quot;</span>);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                                <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                        }</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                }</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                CollectRequest collectRequest = <span class="keyword">new</span> CollectRequest();</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                collectRequest.setRoot(<span class="keyword">new</span> Dependency(artifact, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                <span class="keywordflow">if</span> (repositoryUrl == null) {</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                        collectRequest.addRepository(repos.get(CENTRAL_REPO));</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                }</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                collectRequest.addRepository(repo);</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                CollectResult collectResult;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                <span class="keywordflow">try</span> {</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                        collectResult = mvnSystem.collectDependencies(session, collectRequest);</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                        <span class="keywordflow">return</span> getDependencyPrint(collectResult.getRoot(), 0);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                }</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                <span class="keywordflow">catch</span> (DependencyCollectionException e) {</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                        log.error(<span class="stringliteral">&quot;Could not print dependencies for &quot;</span>.concat(artifactId).concat(<span class="stringliteral">&quot;.&quot;</span>));</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                }</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        }</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <span class="keyword">private</span> String getDependencyPrint(DependencyNode startNode, <span class="keywordtype">int</span> depth) {</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                String d = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; depth; i++) {</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                        d += <span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                }</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                d += depth == 0 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;+- &quot;</span>;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                d += startNode.getArtifact().toString().concat(<span class="stringliteral">&quot; (&quot;</span>).concat(startNode.getDependency().getScope()).concat(<span class="stringliteral">&quot;)&quot;</span>);</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                <span class="keywordflow">for</span> (DependencyNode node : startNode.getChildren()) {</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                        d += System.lineSeparator().concat(getDependencyPrint(node, depth + 1));</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                }</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                <span class="keywordflow">return</span> d;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        }</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno"><a class="line" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#af9bd828208f0c36c5782fbc2a3e6baf5">  832</a></span>&#160;        <span class="keyword">protected</span> String <a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#af9bd828208f0c36c5782fbc2a3e6baf5">printDependencies</a>(Bundle bundle) { <span class="comment">// NO UCD (unused code)</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                String[] coords = null;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                <span class="keywordflow">for</span> (String s : forbiddenFruits) {</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                        coords = s.split(DELIMITER);</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                        <span class="keywordflow">if</span> (bundle != null &amp;&amp; coords.length == 6 &amp;&amp; coords[5].equals(bundle.getSymbolicName())) {</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                                <span class="keywordflow">return</span> <a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#ad94713d67dee7e7b228b5a7a0545b6a4">printDependencies</a>(coords[0], coords[1], coords[3].replace(<span class="stringliteral">&quot;.SNAPSHOT&quot;</span>, <span class="stringliteral">&quot;-SNAPSHOT&quot;</span>), null);</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                        }</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                }</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                <span class="comment">// maven coordinates could not be determined, assume, we talk about a pepper plugin:</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#ad94713d67dee7e7b228b5a7a0545b6a4">printDependencies</a>(bundle.getSymbolicName().substring(0, bundle.getSymbolicName().lastIndexOf(<span class="charliteral">&#39;.&#39;</span>)), bundle.getSymbolicName().substring(bundle.getSymbolicName().lastIndexOf(<span class="charliteral">&#39;.&#39;</span>) + 1), bundle.getVersion().toString(), <a class="code" href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#a1fe636bc1fc7ca39eda1ad4dd3df672e">KORPLING_MAVEN_REPO</a>);</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        }</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <span class="keyword">private</span> <span class="keyword">class </span>MavenRepositoryListener <span class="keyword">extends</span> AbstractRepositoryListener {</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                <span class="keyword">private</span> <span class="keyword">final</span> <span class="keywordtype">boolean</span> TRACE;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                <span class="keyword">private</span> MavenRepositoryListener() {</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                        TRACE = log.isTraceEnabled();</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                }</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                @Override</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> artifactDeployed(RepositoryEvent event) {</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                                log.trace(<span class="stringliteral">&quot;Deployed &quot;</span> + event.getArtifact() + <span class="stringliteral">&quot; to &quot;</span> + <span class="keyword">event</span>.getRepository());</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                        }</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                }</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                @Override</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> artifactDeploying(RepositoryEvent event) {</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                                log.trace(<span class="stringliteral">&quot;Deploying &quot;</span> + event.getArtifact() + <span class="stringliteral">&quot; to &quot;</span> + <span class="keyword">event</span>.getRepository());</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                        }</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                }</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                @Override</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> artifactDescriptorInvalid(RepositoryEvent event) {</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                                log.trace(<span class="stringliteral">&quot;Invalid artifact descriptor for &quot;</span> + event.getArtifact() + <span class="stringliteral">&quot;: &quot;</span> + <span class="keyword">event</span>.getException().getMessage());</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                        }</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                }</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                @Override</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> artifactDescriptorMissing(RepositoryEvent event) {</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                                log.trace(<span class="stringliteral">&quot;Missing artifact descriptor for &quot;</span> + event.getArtifact());</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                        }</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                }</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                @Override</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> artifactInstalled(RepositoryEvent event) {</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                                log.trace(<span class="stringliteral">&quot;Installed &quot;</span> + event.getArtifact() + <span class="stringliteral">&quot; to &quot;</span> + <span class="keyword">event</span>.getFile());</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                        }</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                }</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                @Override</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> artifactInstalling(RepositoryEvent event) {</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                                log.trace(<span class="stringliteral">&quot;Installing &quot;</span> + event.getArtifact() + <span class="stringliteral">&quot; to &quot;</span> + <span class="keyword">event</span>.getFile());</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                        }</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                }</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                @Override</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> artifactResolved(RepositoryEvent event) {</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                                log.trace(<span class="stringliteral">&quot;Resolved artifact &quot;</span> + event.getArtifact() + <span class="stringliteral">&quot; from &quot;</span> + <span class="keyword">event</span>.getRepository());</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                        }</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                }</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                @Override</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> artifactDownloading(RepositoryEvent event) {</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                                log.trace(<span class="stringliteral">&quot;Downloading artifact &quot;</span> + event.getArtifact() + <span class="stringliteral">&quot; from &quot;</span> + <span class="keyword">event</span>.getRepository());</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                        }</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                }</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                @Override</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> artifactDownloaded(RepositoryEvent event) {</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                                log.trace(<span class="stringliteral">&quot;Downloaded artifact &quot;</span> + event.getArtifact() + <span class="stringliteral">&quot; from &quot;</span> + <span class="keyword">event</span>.getRepository());</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                        }</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                }</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                @Override</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> artifactResolving(RepositoryEvent event) {</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                                log.trace(<span class="stringliteral">&quot;Resolving artifact &quot;</span> + event.getArtifact());</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                        }</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                }</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                @Override</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> metadataDeployed(RepositoryEvent event) {</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                                log.trace(<span class="stringliteral">&quot;Deployed &quot;</span> + event.getMetadata() + <span class="stringliteral">&quot; to &quot;</span> + <span class="keyword">event</span>.getRepository());</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                        }</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                }</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                @Override</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> metadataDeploying(RepositoryEvent event) {</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                                log.trace(<span class="stringliteral">&quot;Deploying &quot;</span> + event.getMetadata() + <span class="stringliteral">&quot; to &quot;</span> + <span class="keyword">event</span>.getRepository());</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                        }</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                }</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                @Override</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> metadataInstalled(RepositoryEvent event) {</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                                log.trace(<span class="stringliteral">&quot;Installed &quot;</span> + event.getMetadata() + <span class="stringliteral">&quot; to &quot;</span> + <span class="keyword">event</span>.getFile());</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                        }</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                }</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                @Override</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> metadataInstalling(RepositoryEvent event) {</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                                log.trace(<span class="stringliteral">&quot;Installing &quot;</span> + event.getMetadata() + <span class="stringliteral">&quot; to &quot;</span> + <span class="keyword">event</span>.getFile());</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                        }</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                }</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                @Override</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> metadataInvalid(RepositoryEvent event) {</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                                log.trace(<span class="stringliteral">&quot;Invalid metadata {}&quot;</span>, event.getMetadata());</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                        }</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                }</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                @Override</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> metadataResolved(RepositoryEvent event) {</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                                log.trace(<span class="stringliteral">&quot;Resolved metadata &quot;</span> + event.getMetadata() + <span class="stringliteral">&quot; from &quot;</span> + <span class="keyword">event</span>.getRepository());</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                        }</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                }</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                @Override</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> metadataResolving(RepositoryEvent event) {</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                                log.trace(<span class="stringliteral">&quot;Resolving metadata &quot;</span> + event.getMetadata() + <span class="stringliteral">&quot; from &quot;</span> + <span class="keyword">event</span>.getRepository());</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                        }</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                }</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        }</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="keyword">private</span> <span class="keyword">class </span>MavenTransferListener <span class="keyword">extends</span> AbstractTransferListener {</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                <span class="keyword">private</span> <span class="keyword">final</span> <span class="keywordtype">boolean</span> TRACE;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                <span class="keyword">private</span> MavenTransferListener() {</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                        TRACE = log.isTraceEnabled();</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                }</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                @Override</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> transferInitiated(TransferEvent event) {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                        String message = <span class="keyword">event</span>.getRequestType() == TransferEvent.RequestType.PUT ? <span class="stringliteral">&quot;Uploading&quot;</span> : <span class="stringliteral">&quot;Downloading&quot;</span>;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                                log.trace(message + <span class="stringliteral">&quot;: &quot;</span> + event.getResource().getRepositoryUrl() + <span class="keyword">event</span>.getResource().getResourceName());</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                        }</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                }</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                @Override</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> transferProgressed(TransferEvent event) {</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                }</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                @Override</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> transferSucceeded(TransferEvent event) {</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                                transferCompleted(event);</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                                TransferResource resource = <span class="keyword">event</span>.getResource();</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                                <span class="keywordtype">long</span> contentLength = <span class="keyword">event</span>.getTransferredBytes();</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                                <span class="keywordflow">if</span> (contentLength &gt;= 0) {</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                                        String type = (<span class="keyword">event</span>.getRequestType() == TransferEvent.RequestType.PUT ? <span class="stringliteral">&quot;Uploaded&quot;</span> : <span class="stringliteral">&quot;Downloaded&quot;</span>);</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                                        String len = contentLength &gt;= 1024 ? toKB(contentLength) + <span class="stringliteral">&quot; KB&quot;</span> : contentLength + <span class="stringliteral">&quot; B&quot;</span>;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                                        String throughput = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                                        <span class="keywordtype">long</span> duration = System.currentTimeMillis() - resource.getTransferStartTime();</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                                        <span class="keywordflow">if</span> (duration &gt; 0) {</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                                                <span class="keywordtype">long</span> bytes = contentLength - resource.getResumeOffset();</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                                                DecimalFormat format = <span class="keyword">new</span> DecimalFormat(<span class="stringliteral">&quot;0.0&quot;</span>, <span class="keyword">new</span> DecimalFormatSymbols(Locale.ENGLISH));</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                                                <span class="keywordtype">double</span> kbPerSec = (bytes / 1024.0) / (duration / 1000.0);</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                                                throughput = <span class="stringliteral">&quot; at &quot;</span> + format.format(kbPerSec) + <span class="stringliteral">&quot; KB/sec&quot;</span>;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                                        }</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                                        log.trace(type + <span class="stringliteral">&quot;: &quot;</span> + resource.getRepositoryUrl() + resource.getResourceName() + <span class="stringliteral">&quot; (&quot;</span> + len + throughput + <span class="stringliteral">&quot;)&quot;</span>);</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                                }</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                        }</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                }</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                @Override</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> transferFailed(TransferEvent event) {</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                                transferCompleted(event);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                                <span class="keywordflow">if</span> (!(event.getException() instanceof MetadataNotFoundException)) {</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                                        log.trace(<span class="stringliteral">&quot;An error occured transfering &quot;</span> + event.getResource(), <span class="keyword">event</span>.getException());</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                                }</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                        }</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                }</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                <span class="keyword">private</span> <span class="keywordtype">void</span> transferCompleted(TransferEvent event) {</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                        log.trace(<span class="stringliteral">&quot;Transfer completed.&quot;</span>);</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                }</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                @Override</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> transferCorrupted(TransferEvent event) {</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                        <span class="keywordflow">if</span> (TRACE) {</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                                log.trace(<span class="stringliteral">&quot;Transfer corrupted.&quot;</span>, event.getException());</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                        }</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                }</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                <span class="keyword">protected</span> <span class="keywordtype">long</span> toKB(<span class="keywordtype">long</span> bytes) {</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                        <span class="keywordflow">return</span> (bytes + 1023) / 1024;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                }</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        }</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="keyword">private</span> <span class="keyword">class </span>POMReader <span class="keyword">extends</span> DefaultHandler2 {</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                <span class="keyword">private</span> <span class="keywordtype">boolean</span> read = <span class="keyword">true</span>;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                <span class="keyword">static</span> <span class="keyword">final</span> String TAG_REPOSITORIES = <span class="stringliteral">&quot;repositories&quot;</span>;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                <span class="keyword">static</span> <span class="keyword">final</span> String TAG_REPOSITORY = <span class="stringliteral">&quot;repository&quot;</span>;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                <span class="keyword">static</span> <span class="keyword">final</span> String TAG_URL = <span class="stringliteral">&quot;url&quot;</span>;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                <span class="keyword">static</span> <span class="keyword">final</span> String TAG_ID = <span class="stringliteral">&quot;id&quot;</span>;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                <span class="keyword">static</span> <span class="keyword">final</span> String ROOT_TAG = <span class="stringliteral">&quot;project&quot;</span>;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                <span class="keyword">private</span> String pppparent = null;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                <span class="keyword">private</span> String ppparent = null;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                <span class="keyword">private</span> String pparent = null;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                <span class="keyword">private</span> String parent = null;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                <span class="keyword">private</span> String currTag = null;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                <span class="keyword">private</span> StringBuilder chars = null;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                <span class="keyword">private</span> String url = null;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                <span class="keyword">private</span> String <span class="keywordtype">id</span> = null;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                <span class="keyword">private</span> List&lt;RemoteRepository&gt; resultsList;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                <span class="keyword">private</span> POMReader(List&lt;RemoteRepository&gt; targetList) {</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                        chars = <span class="keyword">new</span> StringBuilder();</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                        resultsList = targetList;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                }</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                @Override</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> startElement(String uri, String localName, String qName, Attributes attributes) {</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                        <span class="keywordflow">if</span> (read) {</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                                localName = qName.substring(qName.lastIndexOf(<span class="stringliteral">&quot;:&quot;</span>) + 1);</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                                pppparent = ppparent;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                                ppparent = pparent;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                                pparent = parent;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                                parent = currTag;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                                currTag = localName;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                                chars.delete(0, chars.length());</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                        }</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                }</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                @Override</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> characters(<span class="keywordtype">char</span>[] ch, <span class="keywordtype">int</span> start, <span class="keywordtype">int</span> length) <span class="keywordflow">throws</span> SAXException {</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                        <span class="keywordflow">if</span> (read &amp;&amp; ROOT_TAG.equals(ppparent) &amp;&amp; TAG_REPOSITORIES.equals(pparent) &amp;&amp; TAG_REPOSITORY.equals(parent) &amp;&amp; (TAG_ID.equals(currTag) || TAG_URL.equals(currTag))) {</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = start; i &lt; start + length; i++) {</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                                        chars.append(ch[i]);</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                                }</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                        }</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                }</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                @Override</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                <span class="keyword">public</span> <span class="keywordtype">void</span> endElement(java.lang.String uri, String localName, String qName) <span class="keywordflow">throws</span> SAXException {</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                        <span class="keywordflow">if</span> (read) {</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                                localName = qName.substring(qName.lastIndexOf(<span class="stringliteral">&quot;:&quot;</span>) + 1);</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                                <span class="keywordtype">boolean</span> constraint = ROOT_TAG.equals(ppparent) &amp;&amp; TAG_REPOSITORIES.equals(pparent) &amp;&amp; TAG_REPOSITORY.equals(parent);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                                <span class="keywordflow">if</span> (constraint &amp;&amp; TAG_URL.equals(localName)) {</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                                        url = chars.toString();</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                                }</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (constraint &amp;&amp; TAG_ID.equals(localName)) {</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                                        <span class="keywordtype">id</span> = chars.toString();</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                                }</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ROOT_TAG.equals(pparent) &amp;&amp; TAG_REPOSITORIES.equals(parent) &amp;&amp; TAG_REPOSITORY.equals(localName)) {</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                                        resultsList.add(getRepo(<span class="keywordtype">id</span>, url));</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                                }</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ROOT_TAG.equals(parent) &amp;&amp; TAG_REPOSITORIES.equals(localName)) {</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                                        read = <span class="keyword">false</span>;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                                }</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                                chars.delete(0, chars.length());</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                                currTag = parent;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                                parent = pparent;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                                pparent = ppparent;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                                ppparent = pppparent;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                                pppparent = null;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                        }</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                }</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        }</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;}</div><div class="ttc" id="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor_html_a1034a18ed961180122b66796840aef79"><div class="ttname"><a href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#a1034a18ed961180122b66796840aef79">org.corpus_tools.atomic.projects.pepper.AtomicMavenAccessor.getBlacklist</a></div><div class="ttdeci">String getBlacklist()</div><div class="ttdef"><b>Definition:</b> <a href="_atomic_maven_accessor_8java_source.html#l00663">AtomicMavenAccessor.java:663</a></div></div>
<div class="ttc" id="namespaceorg_1_1eclipse_html"><div class="ttname"><a href="namespaceorg_1_1eclipse.html">org.eclipse</a></div></div>
<div class="ttc" id="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor_html_ad94713d67dee7e7b228b5a7a0545b6a4"><div class="ttname"><a href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#ad94713d67dee7e7b228b5a7a0545b6a4">org.corpus_tools.atomic.projects.pepper.AtomicMavenAccessor.printDependencies</a></div><div class="ttdeci">String printDependencies(String groupId, String artifactId, String version, String repositoryUrl)</div><div class="ttdoc">This method starts invokes the computation of the dependency tree. </div><div class="ttdef"><b>Definition:</b> <a href="_atomic_maven_accessor_8java_source.html#l00768">AtomicMavenAccessor.java:768</a></div></div>
<div class="ttc" id="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor_html_a16b6f3435123f00ec38117760b81ef6f"><div class="ttname"><a href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#a16b6f3435123f00ec38117760b81ef6f">org.corpus_tools.atomic.projects.pepper.AtomicMavenAccessor.AtomicMavenAccessor</a></div><div class="ttdeci">AtomicMavenAccessor(AtomicPepperOSGiConnector atomicPepperOSGiConnector)</div><div class="ttdef"><b>Definition:</b> <a href="_atomic_maven_accessor_8java_source.html#l00176">AtomicMavenAccessor.java:176</a></div></div>
<div class="ttc" id="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_pepper_o_s_gi_connector_html_a17789d908d5adfe549a2fbf5615d0175"><div class="ttname"><a href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_pepper_o_s_gi_connector.html#a17789d908d5adfe549a2fbf5615d0175">org.corpus_tools.atomic.projects.pepper.AtomicPepperOSGiConnector.start</a></div><div class="ttdeci">void start(Long bundleId)</div><div class="ttdoc">Starts the passed bundle. </div><div class="ttdef"><b>Definition:</b> <a href="_atomic_pepper_o_s_gi_connector_8java_source.html#l00197">AtomicPepperOSGiConnector.java:197</a></div></div>
<div class="ttc" id="namespaceorg_html"><div class="ttname"><a href="namespaceorg.html">org</a></div></div>
<div class="ttc" id="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_pepper_o_s_gi_connector_html_a6596ca087fcd84ddccfabd898c382a51"><div class="ttname"><a href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_pepper_o_s_gi_connector.html#a6596ca087fcd84ddccfabd898c382a51">org.corpus_tools.atomic.projects.pepper.AtomicPepperOSGiConnector.installAndCopy</a></div><div class="ttdeci">Bundle installAndCopy(URI bundleURI)</div><div class="ttdoc">Installs the given bundle and copies it to the plugin path, but does not start it. </div><div class="ttdef"><b>Definition:</b> <a href="_atomic_pepper_o_s_gi_connector_8java_source.html#l00251">AtomicPepperOSGiConnector.java:251</a></div></div>
<div class="ttc" id="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor_html_a69ac225bddc2696dd2a64d15399df6d8"><div class="ttname"><a href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#a69ac225bddc2696dd2a64d15399df6d8">org.corpus_tools.atomic.projects.pepper.AtomicMavenAccessor.ARTIFACT_ID_PEPPER_FRAMEWORK</a></div><div class="ttdeci">static final String ARTIFACT_ID_PEPPER_FRAMEWORK</div><div class="ttdoc">this String contains the artifactId of pepper-framework. </div><div class="ttdef"><b>Definition:</b> <a href="_atomic_maven_accessor_8java_source.html#l00137">AtomicMavenAccessor.java:137</a></div></div>
<div class="ttc" id="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor_html_aec2f0e60a26143385856dec6ce3494f0"><div class="ttname"><a href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#aec2f0e60a26143385856dec6ce3494f0">org.corpus_tools.atomic.projects.pepper.AtomicMavenAccessor.SONATYPE_SNAPSHOTS_REPO</a></div><div class="ttdeci">static final String SONATYPE_SNAPSHOTS_REPO</div><div class="ttdoc">Path to Sonatype Snapshots Maven repo. </div><div class="ttdef"><b>Definition:</b> <a href="_atomic_maven_accessor_8java_source.html#l00145">AtomicMavenAccessor.java:145</a></div></div>
<div class="ttc" id="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor_html_aa5c99f04d292609f9c0744f8e3f5b718"><div class="ttname"><a href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#aa5c99f04d292609f9c0744f8e3f5b718">org.corpus_tools.atomic.projects.pepper.AtomicMavenAccessor.update</a></div><div class="ttdeci">boolean update(String groupId, String artifactId, String repositoryUrl, boolean isSnapshot, boolean ignoreFrameworkVersion, Bundle installedBundle)</div><div class="ttdoc">This method checks the provided pepper plugin for updates and triggers the installation process if a ...</div><div class="ttdef"><b>Definition:</b> <a href="_atomic_maven_accessor_8java_source.html#l00343">AtomicMavenAccessor.java:343</a></div></div>
<div class="ttc" id="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor_html_a6f0f58c5787d0e826714364ebf136454"><div class="ttname"><a href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#a6f0f58c5787d0e826714364ebf136454">org.corpus_tools.atomic.projects.pepper.AtomicMavenAccessor.CENTRAL_REPO</a></div><div class="ttdeci">static final String CENTRAL_REPO</div><div class="ttdoc">path to maven central </div><div class="ttdef"><b>Definition:</b> <a href="_atomic_maven_accessor_8java_source.html#l00143">AtomicMavenAccessor.java:143</a></div></div>
<div class="ttc" id="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_pepper_o_s_gi_connector_html"><div class="ttname"><a href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_pepper_o_s_gi_connector.html">org.corpus_tools.atomic.projects.pepper.AtomicPepperOSGiConnector</a></div><div class="ttdoc">This class is an implementation of Pepper. </div><div class="ttdef"><b>Definition:</b> <a href="_atomic_pepper_o_s_gi_connector_8java_source.html#l00069">AtomicPepperOSGiConnector.java:69</a></div></div>
<div class="ttc" id="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor_html"><div class="ttname"><a href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html">org.corpus_tools.atomic.projects.pepper.AtomicMavenAccessor</a></div><div class="ttdoc">This class provides the functionality to operate with Maven repositories, e.g., in the update process...</div><div class="ttdef"><b>Definition:</b> <a href="_atomic_maven_accessor_8java_source.html#l00127">AtomicMavenAccessor.java:127</a></div></div>
<div class="ttc" id="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_pepper_o_s_gi_connector_html_a816cf5501b5a7e32d20fedc2c1f99d79"><div class="ttname"><a href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_pepper_o_s_gi_connector.html#a816cf5501b5a7e32d20fedc2c1f99d79">org.corpus_tools.atomic.projects.pepper.AtomicPepperOSGiConnector.getAtomicPepperConfiguration</a></div><div class="ttdeci">AtomicPepperConfiguration getAtomicPepperConfiguration()</div><div class="ttdef"><b>Definition:</b> <a href="_atomic_pepper_o_s_gi_connector_8java_source.html#l00221">AtomicPepperOSGiConnector.java:221</a></div></div>
<div class="ttc" id="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor_html_a1fe636bc1fc7ca39eda1ad4dd3df672e"><div class="ttname"><a href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#a1fe636bc1fc7ca39eda1ad4dd3df672e">org.corpus_tools.atomic.projects.pepper.AtomicMavenAccessor.KORPLING_MAVEN_REPO</a></div><div class="ttdeci">static final String KORPLING_MAVEN_REPO</div><div class="ttdoc">path to korpling maven repo </div><div class="ttdef"><b>Definition:</b> <a href="_atomic_maven_accessor_8java_source.html#l00141">AtomicMavenAccessor.java:141</a></div></div>
<div class="ttc" id="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor_html_af9bd828208f0c36c5782fbc2a3e6baf5"><div class="ttname"><a href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#af9bd828208f0c36c5782fbc2a3e6baf5">org.corpus_tools.atomic.projects.pepper.AtomicMavenAccessor.printDependencies</a></div><div class="ttdeci">String printDependencies(Bundle bundle)</div><div class="ttdoc">This method tries to determine maven project coordinates from a bundle id to invoke printDependencies...</div><div class="ttdef"><b>Definition:</b> <a href="_atomic_maven_accessor_8java_source.html#l00832">AtomicMavenAccessor.java:832</a></div></div>
<div class="ttc" id="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor_html_ab3d577efb7764c29cf46587027a207ad"><div class="ttname"><a href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_maven_accessor.html#ab3d577efb7764c29cf46587027a207ad">org.corpus_tools.atomic.projects.pepper.AtomicMavenAccessor.ARTIFACT_ID_PEPPER_PARENT</a></div><div class="ttdeci">static final String ARTIFACT_ID_PEPPER_PARENT</div><div class="ttdoc">this String contains the artifactId of pepper-parentModule. </div><div class="ttdef"><b>Definition:</b> <a href="_atomic_maven_accessor_8java_source.html#l00139">AtomicMavenAccessor.java:139</a></div></div>
<div class="ttc" id="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_pepper_configuration_html_a4e66aa0dfa500ba292d7c85eb2ef5b40"><div class="ttname"><a href="classorg_1_1corpus__tools_1_1atomic_1_1projects_1_1pepper_1_1_atomic_pepper_configuration.html#a4e66aa0dfa500ba292d7c85eb2ef5b40">org.corpus_tools.atomic.projects.pepper.AtomicPepperConfiguration.getTempPath</a></div><div class="ttdeci">File getTempPath()</div><div class="ttdoc">Returns a temporary path, where the entire system and all modules can store temp files. </div><div class="ttdef"><b>Definition:</b> <a href="_atomic_pepper_configuration_8java_source.html#l00128">AtomicPepperConfiguration.java:128</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_38c8d24aef3972a7f87b834274e76e31.html">plugins</a></li><li class="navelem"><a class="el" href="dir_ed6c6732d205002425d38f991d82a6ae.html">org.corpus-tools.atomic</a></li><li class="navelem"><a class="el" href="dir_3cf83c1ebb1bc7e4d602e96399c74ef7.html">src</a></li><li class="navelem"><a class="el" href="dir_3ad7d840ef2f72185c5eec565a77ce26.html">main</a></li><li class="navelem"><a class="el" href="dir_8e46a24fc5443c1423ebf430d55d9c1a.html">java</a></li><li class="navelem"><a class="el" href="dir_ca868f7cb38f67417aae7ed3997c5b5e.html">org</a></li><li class="navelem"><a class="el" href="dir_766bc916bd18db847c161ff4f038b251.html">corpus_tools</a></li><li class="navelem"><a class="el" href="dir_b518ccd0a814f776eb46e1506845c141.html">atomic</a></li><li class="navelem"><a class="el" href="dir_7b9149edbd98f1c50bb73fe6bad6637d.html">projects</a></li><li class="navelem"><a class="el" href="dir_bedf0fbd7d31cc9789ad510c96c4d51b.html">pepper</a></li><li class="navelem"><b>AtomicMavenAccessor.java</b></li>
    <li class="footer">Generated on Wed Mar 8 2017 15:12:37 for Atomic Developer Documentation by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
